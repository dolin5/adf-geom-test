{"version":3,"sources":["../node_modules/@stencil/core/internal/client lazy /^/.*$/ include: /.entry/.js$/ exclude: /.system/.entry/.js$/ groupOptions: {} namespace object","ArcGISMap.tsx","ProjectPane.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","platingProjectIDfield","dissolveBeyondScale","createPPIDArray","features","dict","forEach","g","attributes","push","dissolvePoints","index","graphics","JSON","parse","stringify","point","Graphic","geometry","averagePointsGeom","x","reduce","sum","length","y","spatialReference","Point","ArcGISMap","setProjects","sendMapView","setGeoms","mapDiv","useRef","useEffect","current","map","Map","basemap","view","MapView","container","zoom","padding","left","center","popup","defaultPopupTemplateEnabled","polygonRenderer","type","symbol","outline","color","pointRenderer","size","polygonLayer","FeatureLayer","url","minScale","renderer","outFields","pointLayer","objectIdField","popupEnabled","watch","scale","projectQuery","where","returnGeometry","returnDistinctValues","all","queryFeatures","r","polyQuery","f","join","pointQuery","polygonFeatures","pointFeatures","polygonCentroidGraphics","centroid","mergedPoints","mergedArrays","dissolvedPoints","Object","entries","popupTemplate","createPopupTemplate","title","fields","filter","fpnt","fplyg","name","includes","zoomedOutLayer","source","maxScale","addMany","className","ref","ProjectPane","projects","onProjectClick","style","position","top","bottom","width","zIndex","background","display","flexDirection","overflowY","project","i","height","justifyContent","flexShrink","borderBottom","onClick","App","useState","setView","geoms","goTo","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.194001df.chunk.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 387;","import React, { useEffect, useRef, useState } from 'react'\nimport MapView from '@arcgis/core/views/MapView'\nimport Map from '@arcgis/core/Map';\nimport FeatureLayer from '@arcgis/core/layers/FeatureLayer';\nimport Polygon from '@arcgis/core/geometry/Polygon';\nimport Point from '@arcgis/core/geometry/Point';\nimport Graphic from '@arcgis/core/Graphic';\nimport SimpleMarkerSymbol from '@arcgis/core/symbols/SimpleMarkerSymbol';\nimport SimpleRenderer from '@arcgis/core/renderers/SimpleRenderer';\nimport Query from '@arcgis/core/tasks/support/Query';\nimport PopupTemplate from '@arcgis/core/PopupTemplate';\nimport PolygonCentroidLayer from './PolygonCentroidLayer';\n\nconst platingProjectIDfield = \"PlantingProjectID\"\n\nconst dissolveBeyondScale = 4999999;\n\nconst ArcGISMap = ({setProjects,sendMapView, setGeoms}:{setProjects:any, sendMapView:(view:MapView)=>void, setGeoms:any})=>{    \n  const mapDiv = useRef(null);\n\n  useEffect(() => {\n    if (mapDiv.current) {\n      /**\n       * Initialize application\n       */\n      const map = new Map({\n        basemap: \"streets-vector\"\n\n      });\n\n      const view = new MapView({\n        container: mapDiv.current!,\n        map,\n        zoom:3,\n        padding:{left:400},\n        center:[-100,39]\n      });\n\n      sendMapView(view);\n\n      view.popup.defaultPopupTemplateEnabled= true;\n\n      const polygonRenderer = {\n        type:'simple',\n        symbol:{\n        type:'simple-fill',\n        outline: {           color: [0, 196, 0, 1] },\n        color: [0, 196, 0, .25]}\n      } as unknown as SimpleRenderer;\n\n      const pointRenderer = {\n        type:'simple',\n        symbol:{\n          type:'simple-marker',\n          size:8,              \n          outline: { color: [0, 196, 0, 1] },\n          color: [0, 196, 0, .5]\n        } \n      } as unknown as SimpleRenderer;\n\n      const polygonLayer = new FeatureLayer({\n        url:\"https://gis-test.arborday.org/server/rest/services/CP_Showcase_MVP_Data_Polygon/FeatureServer/0\",\n        minScale:dissolveBeyondScale,\n        renderer:polygonRenderer,\n        outFields:['*']\n      });\n\n      const pointLayer = new FeatureLayer({\n        url:\"https://gis-test.arborday.org/server/rest/services/CP_Showcase_MVP_Data_Points/FeatureServer/0\",\n        objectIdField:'OBJECTID',\n        renderer:pointRenderer, \n        minScale:dissolveBeyondScale,\n        outFields:['*'],\n        popupEnabled:true,\n      });\n\n      view.watch(\"scale\",scale=>{\n        polygonLayer.renderer = scale>=100000?pointRenderer:polygonRenderer\n      })\n\n      const projectQuery = {where:\"1=1\", outFields:[platingProjectIDfield,'PlantingProjectName','PlantingProjectType','CalendarYear','AcresRestored'], returnGeometry:false, returnDistinctValues:true} as Query;\n      Promise.all([polygonLayer.queryFeatures(projectQuery),pointLayer.queryFeatures(projectQuery)]).then(r=>{      \n        setProjects([...r[0].features,...r[1].features]);\n        const polyQuery = {where:\"PlantingProjectID IN (\"+r[0].features.map(f=>f.attributes[platingProjectIDfield]).join(',')+\")\",outFields:['*'], returnGeometry:true} as Query\n        const pointQuery = {where:\"PlantingProjectID IN (\"+r[1].features.map(f=>f.attributes[platingProjectIDfield]).join(',')+\")\",outFields:['*'], returnGeometry:true} as Query        \n\n        Promise.all([polygonLayer.queryFeatures(polyQuery), pointLayer.queryFeatures(pointQuery)]).then(r=>{\n          const polygonFeatures = r[0].features;\n          const pointFeatures = r[1].features;\n          setGeoms([...polygonFeatures,...pointFeatures]);\n          const polygonCentroidGraphics = polygonFeatures.map(f=>{\n            return new Graphic({attributes:f.attributes,geometry:(f.geometry as Polygon).centroid})\n          })\n\n          const mergedPoints = [...polygonCentroidGraphics, ...pointFeatures];\n          const mergedArrays = createPPIDArray(mergedPoints);\n\n          const dissolvedPoints:Graphic[] = Object.entries(mergedArrays).map(dissolvePoints);\n\n          const popupTemplate = pointLayer.createPopupTemplate();\n          popupTemplate.title= '{PlantingProjectName}'\n\n        \n          const fields = pointLayer.fields.filter(fpnt=>polygonLayer.fields.map(fplyg=>fplyg.name).includes(fpnt.name));\n\n          const zoomedOutLayer = new FeatureLayer({\n            source:dissolvedPoints, objectIdField:'OBJECTID',renderer:pointRenderer,\n            maxScale:5000000,\n            fields,\n            popupTemplate\n          });\n\n          \n          \n          map.addMany([zoomedOutLayer]);\n        } )   \n     \n      })\n      map.addMany([polygonLayer,pointLayer]);\n\n\n    }\n  }, []);\n\n  return <div className=\"mapDiv\" ref={mapDiv}></div>;\n}\n\nconst createPPIDArray= (features:Graphic[]): {[key: string]: Graphic[]}=>{\n  const dict = {} as {[key: string]: Graphic[]};\n\n  features.forEach(g=>{\n    dict[g.attributes[platingProjectIDfield]] = dict[g.attributes[platingProjectIDfield]] || [];\n    dict[g.attributes[platingProjectIDfield]].push(g);\n  })\n  return dict;  \n}\n\nconst dissolvePoints = ([id,graphics]:[string,Graphic[]],index:number)=>{\n  const attributes = JSON.parse(JSON.stringify(graphics[0].attributes));\n  attributes['OBJECTID'] = index;\n    const point = new Graphic({attributes})\n    point.geometry = averagePointsGeom(graphics);\n    return point;\n}\n\nconst averagePointsGeom = (graphics:Graphic[]):Point=>{\n    const x = graphics.reduce((sum,g)=>sum+(g.geometry as Point).x,0)/graphics.length;\n    const y = graphics.reduce((sum,g)=>sum+(g.geometry as Point).y,0)/graphics.length;\n    const spatialReference = graphics[0].geometry.spatialReference;\n    return new Point({spatialReference,x,y});\n}\n\nconst generatePopup = (feature:Graphic)=>{\n  console.log(feature);\n  return JSON.stringify(feature);\n}\n\n\nexport default ArcGISMap","import Graphic from '@arcgis/core/Graphic';\nimport React from 'react';\n\n\nconst ProjectPane = ({projects,onProjectClick}:{projects?:Graphic[],onProjectClick:(graphic:Graphic)=>void})=>{\n\n    return <div style={{position:'absolute',top:20,bottom:20,left:20,width:350, zIndex:1000, \n        background:'white', display:'flex', flexDirection:'column', overflowY:'scroll'}}>\n        {projects?.map((project,i)=>{\n            return <div style={{height:80, padding:20, display:'flex',flexDirection:'column', justifyContent:'space-around', flexShrink:0, borderBottom:'1px solid black', color:'black'}} key={i} onClick={()=>onProjectClick(project)}>\n                <h3>{project.attributes['PlantingProjectName']}</h3>\n                <p>{project.attributes['PlantingProjectID']}</p>\n            </div>\n        })}\n    </div>\n\n}\n\nexport default ProjectPane;","import React, { useRef, useState } from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport ArcGISMap from './ArcGISMap'\nimport Graphic from '@arcgis/core/Graphic';\nimport ProjectPane from './ProjectPane';\nimport MapView from '@arcgis/core/views/MapView';\n\nfunction App() {\n  const mapRef = useRef();\n\n  const [view,setView]=useState<MapView>();\n\n  const [projects,setProjects] = useState<Graphic[]>();\n  const [geoms,setGeoms ] = useState<any>();\n  const getMapView = (view:MapView)=>{    \n    setView(view);\n  }\n\n  const onProjectClick = (project:Graphic)=>{\n    view?.goTo(geoms.filter((g:Graphic)=>{return g.attributes['PlantingProjectID']==project.attributes['PlantingProjectID']}));\n  }\n\n  return (\n    <div className=\"App\">\n      {/* <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <p>\n          Edit <code>src/App.tsx</code> and save to reload.\n        </p>\n        <a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Learn React\n        </a>\n      </header> */}\n      <ProjectPane projects={projects} onProjectClick={onProjectClick}></ProjectPane>\n      <ArcGISMap sendMapView={getMapView} setProjects={setProjects} setGeoms={setGeoms}></ArcGISMap>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}