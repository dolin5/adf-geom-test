(this["webpackJsonpadf-geom-test"]=this["webpackJsonpadf-geom-test"]||[]).push([[46],{384:function(e,t,r){},385:function(e,t,r){},387:function(e,t){function r(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=387},389:function(e,t,r){"use strict";r.r(t);var n=r(119),a=r.n(n),o=r(374),i=r.n(o),c=(r(384),r(22)),s=(r(385),r(27)),u=r(375),l=r(297),d=r(209),f=r(41),j=r(73),p=r(104),b="PlantingProjectID",m=4999999,P=function(e){var t={};return e.forEach((function(e){t[e.attributes.PlantingProjectID]=t[e.attributes.PlantingProjectID]||[],t[e.attributes.PlantingProjectID].push(e)})),t},g=function(e,t){var r=Object(c.a)(e,2),n=(r[0],r[1]),a=JSON.parse(JSON.stringify(n[0].attributes));a.OBJECTID=t;var o=new j.a({attributes:a});return o.geometry=v(n),o},v=function(e){var t=e.reduce((function(e,t){return e+t.geometry.x}),0)/e.length,r=e.reduce((function(e,t){return e+t.geometry.y}),0)/e.length,n=e[0].geometry.spatialReference;return new f.a({spatialReference:n,x:t,y:r})},y=function(e){var t=e.setProjects,r=e.sendMapView,a=e.setGeoms,o=Object(n.useRef)(null);return Object(n.useEffect)((function(){if(o.current){var e=new l.a({basemap:"streets-vector"}),n=new u.a({container:o.current,map:e,zoom:3,padding:{left:400},center:[-100,39]});r(n),n.popup.defaultPopupTemplateEnabled=!0;var i={type:"simple",symbol:{type:"simple-fill",outline:{color:[0,196,0,1]},color:[0,196,0,.25]}},c={type:"simple",symbol:{type:"simple-marker",size:8,outline:{color:[0,196,0,1]},color:[0,196,0,.5]}},f=new d.default({url:"https://gis-test.arborday.org/server/rest/services/CP_Showcase_MVP_Data_Polygon/FeatureServer/0",minScale:m,renderer:i,outFields:["*"]}),p=new d.default({url:"https://gis-test.arborday.org/server/rest/services/CP_Showcase_MVP_Data_Points/FeatureServer/0",objectIdField:"OBJECTID",renderer:c,minScale:m,outFields:["*"],popupEnabled:!0});n.watch("scale",(function(e){f.renderer=e>=1e5?c:i}));var v={where:"1=1",outFields:[b,"PlantingProjectName","PlantingProjectType","CalendarYear","AcresRestored"],returnGeometry:!1,returnDistinctValues:!0};Promise.all([f.queryFeatures(v),p.queryFeatures(v)]).then((function(r){t([].concat(Object(s.a)(r[0].features),Object(s.a)(r[1].features)));var n={where:"PlantingProjectID IN ("+r[0].features.map((function(e){return e.attributes.PlantingProjectID})).join(",")+")",outFields:["*"],returnGeometry:!0},o={where:"PlantingProjectID IN ("+r[1].features.map((function(e){return e.attributes.PlantingProjectID})).join(",")+")",outFields:["*"],returnGeometry:!0};Promise.all([f.queryFeatures(n),p.queryFeatures(o)]).then((function(t){var r=t[0].features,n=t[1].features;a([].concat(Object(s.a)(r),Object(s.a)(n)));var o=r.map((function(e){return new j.a({attributes:e.attributes,geometry:e.geometry.centroid})})),i=[].concat(Object(s.a)(o),Object(s.a)(n)),u=P(i),l=Object.entries(u).map(g),b=p.createPopupTemplate();b.title="{PlantingProjectName}";var m=p.fields.filter((function(e){return f.fields.map((function(e){return e.name})).includes(e.name)})),v=new d.default({source:l,objectIdField:"OBJECTID",renderer:c,maxScale:5e6,fields:m,popupTemplate:b});e.addMany([v])}))})),e.addMany([f,p])}}),[]),Object(p.jsx)("div",{className:"mapDiv",ref:o})},O=function(e){var t=e.projects,r=e.onProjectClick;return Object(p.jsx)("div",{style:{position:"absolute",top:20,bottom:20,left:20,width:350,zIndex:1e3,background:"white",display:"flex",flexDirection:"column",overflowY:"scroll"},children:null===t||void 0===t?void 0:t.map((function(e,t){return Object(p.jsxs)("div",{style:{height:80,padding:20,display:"flex",flexDirection:"column",justifyContent:"space-around",flexShrink:0,borderBottom:"1px solid black",color:"black"},onClick:function(){return r(e)},children:[Object(p.jsx)("h3",{children:e.attributes.PlantingProjectName}),Object(p.jsx)("p",{children:e.attributes.PlantingProjectID})]},t)}))})};var h=function(){Object(n.useRef)();var e=Object(n.useState)(),t=Object(c.a)(e,2),r=t[0],a=t[1],o=Object(n.useState)(),i=Object(c.a)(o,2),s=i[0],u=i[1],l=Object(n.useState)(),d=Object(c.a)(l,2),f=d[0],j=d[1];return Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(O,{projects:s,onProjectClick:function(e){null===r||void 0===r||r.goTo(f.filter((function(t){return t.attributes.PlantingProjectID==e.attributes.PlantingProjectID})))}}),Object(p.jsx)(y,{sendMapView:function(e){a(e)},setProjects:u,setGeoms:j})]})},w=function(e){e&&e instanceof Function&&r.e(256).then(r.bind(null,835)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,o=t.getLCP,i=t.getTTFB;r(e),n(e),a(e),o(e),i(e)}))};i.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(h,{})}),document.getElementById("root")),w()}},[[389,47,48]]]);
//# sourceMappingURL=main.194001df.chunk.js.map